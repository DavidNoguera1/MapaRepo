{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\David Noguera\\\\Desktop\\\\MapyWorks\\\\control-mapy\\\\src\\\\components\\\\mapa\\\\Mapa.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { MapContainer, TileLayer, Marker, Popup, Circle, useMap } from 'react-leaflet';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\nimport serviceService from '../../services/apiServices';\nimport ServiceCard from '../service_/ServiceCard';\nimport ServiceModal from '../service_/ServiceModal';\nimport Navbar from '../navbar/Navbar';\nimport './Mapa.css';\n\n// Fix for default markers in Leaflet with React\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\ndelete L.Icon.Default.prototype._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png',\n  iconUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png',\n  shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png'\n});\n\n// Custom icon for services\nconst serviceIcon = new L.Icon({\n  iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-orange.png',\n  shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png',\n  iconSize: [25, 41],\n  iconAnchor: [12, 41],\n  popupAnchor: [1, -34],\n  shadowSize: [41, 41]\n});\n\n// Custom icon for user location\nconst userLocationIcon = new L.Icon({\n  iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-blue.png',\n  shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png',\n  iconSize: [25, 41],\n  iconAnchor: [12, 41],\n  popupAnchor: [1, -34],\n  shadowSize: [41, 41]\n});\n\n// Component to handle map events and location detection\nconst MapController = ({\n  onLocationFound,\n  zoneCenter,\n  zoneRadius\n}) => {\n  _s();\n  const map = useMap();\n  useEffect(() => {\n    // Add click handler to update zone center\n    const handleMapClick = e => {\n      onLocationFound(e.latlng, 'click');\n    };\n    map.on('click', handleMapClick);\n    return () => {\n      map.off('click', handleMapClick);\n    };\n  }, [map, onLocationFound]);\n\n  // Update zone circle when center or radius changes\n  useEffect(() => {\n    if (zoneCenter && zoneRadius > 0) {\n      // Remove existing circle\n      map.eachLayer(layer => {\n        if (layer instanceof L.Circle && layer.options.color === 'red') {\n          map.removeLayer(layer);\n        }\n      });\n\n      // Add new circle\n      L.circle(zoneCenter, {\n        radius: zoneRadius,\n        color: 'red',\n        fillColor: '#f03',\n        fillOpacity: 0.2,\n        weight: 2\n      }).addTo(map);\n    }\n  }, [zoneCenter, zoneRadius, map]);\n  return null;\n};\n_s(MapController, \"tm7v5wxt+lXe+JHmDCjcGD98tIQ=\", false, function () {\n  return [useMap];\n});\n_c = MapController;\nconst Mapa = () => {\n  _s2();\n  const [services, setServices] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [zoneCenter, setZoneCenter] = useState(null);\n  const [zoneRadius, setZoneRadius] = useState(1000); // 1km default\n  const [showAllServices, setShowAllServices] = useState(false); // New state for showing all services\n  const [selectedService, setSelectedService] = useState(null);\n  const [showModal, setShowModal] = useState(false);\n  const [mapCenter, setMapCenter] = useState([-34.6037, -58.3816]); // Default to Buenos Aires\n\n  // Load services on component mount\n  useEffect(() => {\n    loadServices();\n  }, []);\n  const loadServices = async () => {\n    setLoading(true);\n    setError(null);\n    try {\n      const response = await serviceService.getServices(0, 1000, ''); // Load all services\n      setServices(response.services);\n    } catch (err) {\n      setError('Error al cargar los servicios');\n      console.error('Error loading services:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Get user current location\n  const handleGetCurrentLocation = () => {\n    if (!navigator.geolocation) {\n      alert('Geolocalización no es soportada por este navegador.');\n      return;\n    }\n\n    // Check if running on HTTPS or localhost\n    const isSecureContext = window.location.protocol === 'https:' || window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';\n    if (!isSecureContext) {\n      alert('Para usar la geolocalización, el sitio debe ejecutarse en HTTPS o localhost. Actualmente estás en: ' + window.location.protocol + '//' + window.location.hostname);\n      return;\n    }\n    console.log('Requesting geolocation...');\n    navigator.geolocation.getCurrentPosition(position => {\n      console.log('Geolocation success:', position.coords);\n      const coords = {\n        lat: position.coords.latitude,\n        lng: position.coords.longitude\n      };\n      setZoneCenter(coords);\n      setMapCenter([coords.lat, coords.lng]);\n      alert('¡Ubicación detectada correctamente!');\n    }, error => {\n      console.error('Geolocation error details:', {\n        code: error.code,\n        message: error.message,\n        PERMISSION_DENIED: error.PERMISSION_DENIED,\n        POSITION_UNAVAILABLE: error.POSITION_UNAVAILABLE,\n        TIMEOUT: error.TIMEOUT\n      });\n      let errorMessage = 'Error al obtener la ubicación: ';\n      switch (error.code) {\n        case error.PERMISSION_DENIED:\n          errorMessage += 'Permisos denegados. Por favor, permite el acceso a la ubicación en tu navegador.';\n          break;\n        case error.POSITION_UNAVAILABLE:\n          errorMessage += 'Ubicación no disponible. Verifica que tu dispositivo tenga GPS activado.';\n          break;\n        case error.TIMEOUT:\n          errorMessage += 'Tiempo agotado. Intenta nuevamente.';\n          break;\n        default:\n          errorMessage += 'Error desconocido. Verifica tu conexión a internet y permisos de ubicación.';\n          break;\n      }\n      alert(errorMessage + '\\n\\nPara desarrollo local, asegúrate de que el sitio se ejecute en localhost con HTTP o HTTPS.');\n    }, {\n      enableHighAccuracy: true,\n      timeout: 15000,\n      // Increased timeout\n      maximumAge: 300000\n    });\n  };\n\n  // Handle location found (either from click or current location)\n  const handleLocationFound = useCallback((coords, source) => {\n    if (source === 'click') {\n      setZoneCenter(coords);\n    }\n  }, []);\n\n  // Calculate distance between two points using Haversine formula\n  const calculateDistance = (point1, point2) => {\n    const R = 6371; // Earth's radius in kilometers\n    const dLat = (point2.lat - point1.lat) * Math.PI / 180;\n    const dLon = (point2.lng - point1.lng) * Math.PI / 180;\n    const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.cos(point1.lat * Math.PI / 180) * Math.cos(point2.lat * Math.PI / 180) * Math.sin(dLon / 2) * Math.sin(dLon / 2);\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n    return R * c;\n  };\n\n  // Filter services based on zone of interest\n  const servicesInZone = services.filter(service => {\n    if (!zoneCenter || !service.lat || !service.lng) return false;\n    const serviceLocation = {\n      lat: service.lat,\n      lng: service.lng\n    };\n    const distance = calculateDistance(zoneCenter, serviceLocation);\n    return distance <= zoneRadius / 1000; // Convert meters to kilometers\n  });\n  const handleViewMore = service => {\n    setSelectedService(service);\n    setShowModal(true);\n  };\n  const handleCloseModal = () => {\n    setShowModal(false);\n    setSelectedService(null);\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Navbar, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mapa-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mapa-controls\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"control-group\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"zone-radius\",\n            children: \"Radio de zona de inter\\xE9s (metros):\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 221,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            id: \"zone-radius\",\n            type: \"range\",\n            min: \"100\",\n            max: \"20000\",\n            step: \"500\",\n            value: zoneRadius,\n            onChange: e => setZoneRadius(parseInt(e.target.value)),\n            className: \"zone-radius-slider\",\n            disabled: showAllServices\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 222,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"radius-value\",\n            children: [zoneRadius, \"m\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 233,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleGetCurrentLocation,\n          className: \"location-button\",\n          children: \"\\uD83D\\uDCCD Detectar Ubicaci\\xF3n Actual\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"control-group\",\n          children: /*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"checkbox-label\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"checkbox\",\n              checked: showAllServices,\n              onChange: e => setShowAllServices(e.target.checked),\n              className: \"show-all-checkbox\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 247,\n              columnNumber: 15\n            }, this), \"Ver todos los servicios (sin zona de inter\\xE9s)\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 246,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 245,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"services-info\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Total de servicios: \", services.length]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 258,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Servicios mostrados: \", showAllServices ? services.length : servicesInZone.length]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 259,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 257,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mapa-content\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"map-container\",\n          children: /*#__PURE__*/_jsxDEV(MapContainer, {\n            center: mapCenter,\n            zoom: 13,\n            style: {\n              height: '100%',\n              width: '100%'\n            },\n            children: [/*#__PURE__*/_jsxDEV(TileLayer, {\n              url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",\n              attribution: \"\\xA9 OpenStreetMap contributors\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 270,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(MapController, {\n              onLocationFound: handleLocationFound,\n              zoneCenter: zoneCenter,\n              zoneRadius: zoneRadius\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 275,\n              columnNumber: 15\n            }, this), services.map(service => {\n              if (!service.lat || !service.lng) return null;\n              const isInZone = zoneCenter ? calculateDistance(zoneCenter, {\n                lat: service.lat,\n                lng: service.lng\n              }) <= zoneRadius / 1000 : false;\n              return /*#__PURE__*/_jsxDEV(Marker, {\n                position: [service.lat, service.lng],\n                icon: serviceIcon,\n                opacity: isInZone ? 1 : 0.5,\n                children: /*#__PURE__*/_jsxDEV(Popup, {\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"service-popup\",\n                    children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                      children: service.title\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 297,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                      children: service.description\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 298,\n                      columnNumber: 25\n                    }, this), service.owner_name && /*#__PURE__*/_jsxDEV(\"p\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                        children: \"Por:\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 299,\n                        columnNumber: 51\n                      }, this), \" \", service.owner_name]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 299,\n                      columnNumber: 48\n                    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                      onClick: () => handleViewMore(service),\n                      className: \"popup-view-more\",\n                      children: \"Ver M\\xE1s\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 300,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 296,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 295,\n                  columnNumber: 21\n                }, this)\n              }, service.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 289,\n                columnNumber: 19\n              }, this);\n            })]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 265,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"services-list\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: [\"Servicios \", showAllServices ? 'Registrados' : zoneCenter ? 'en Zona de Interés' : 'Registrados']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 315,\n            columnNumber: 13\n          }, this), loading && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"loading\",\n            children: \"Cargando servicios...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 317,\n            columnNumber: 25\n          }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"error\",\n            children: error\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 319,\n            columnNumber: 23\n          }, this), !loading && !error && !showAllServices && servicesInZone.length === 0 && zoneCenter && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"no-services\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"No hay servicios en la zona de inter\\xE9s seleccionada.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 323,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Ajusta el radio o mueve el centro de la zona.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 324,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 322,\n            columnNumber: 15\n          }, this), !loading && !error && !showAllServices && servicesInZone.length === 0 && !zoneCenter && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"no-services\",\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Haz clic en el mapa para definir una zona de inter\\xE9s o usa el bot\\xF3n de ubicaci\\xF3n actual.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 330,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 329,\n            columnNumber: 15\n          }, this), !loading && !error && showAllServices && services.length === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"no-services\",\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"No hay servicios registrados en el sistema.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 336,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 335,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"services-grid\",\n            children: (showAllServices ? services : servicesInZone).map(service => /*#__PURE__*/_jsxDEV(ServiceCard, {\n              service: service,\n              onViewMore: handleViewMore,\n              onOwnerClick: () => {} // TODO: Implement owner click if needed\n            }, service.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 342,\n              columnNumber: 17\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 340,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 314,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 9\n      }, this), showModal && selectedService && /*#__PURE__*/_jsxDEV(ServiceModal, {\n        service: selectedService,\n        onClose: handleCloseModal,\n        onUpdate: () => loadServices()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 354,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n_s2(Mapa, \"HZzlEv2o6lqwUkFRwr8NvvPdmCg=\");\n_c2 = Mapa;\nexport default Mapa;\nvar _c, _c2;\n$RefreshReg$(_c, \"MapController\");\n$RefreshReg$(_c2, \"Mapa\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","MapContainer","TileLayer","Marker","Popup","Circle","useMap","L","serviceService","ServiceCard","ServiceModal","Navbar","jsxDEV","_jsxDEV","Fragment","_Fragment","Icon","Default","prototype","_getIconUrl","mergeOptions","iconRetinaUrl","iconUrl","shadowUrl","serviceIcon","iconSize","iconAnchor","popupAnchor","shadowSize","userLocationIcon","MapController","onLocationFound","zoneCenter","zoneRadius","_s","map","handleMapClick","e","latlng","on","off","eachLayer","layer","options","color","removeLayer","circle","radius","fillColor","fillOpacity","weight","addTo","_c","Mapa","_s2","services","setServices","loading","setLoading","error","setError","setZoneCenter","setZoneRadius","showAllServices","setShowAllServices","selectedService","setSelectedService","showModal","setShowModal","mapCenter","setMapCenter","loadServices","response","getServices","err","console","handleGetCurrentLocation","navigator","geolocation","alert","isSecureContext","window","location","protocol","hostname","log","getCurrentPosition","position","coords","lat","latitude","lng","longitude","code","message","PERMISSION_DENIED","POSITION_UNAVAILABLE","TIMEOUT","errorMessage","enableHighAccuracy","timeout","maximumAge","handleLocationFound","source","calculateDistance","point1","point2","R","dLat","Math","PI","dLon","a","sin","cos","c","atan2","sqrt","servicesInZone","filter","service","serviceLocation","distance","handleViewMore","handleCloseModal","children","fileName","_jsxFileName","lineNumber","columnNumber","className","htmlFor","id","type","min","max","step","value","onChange","parseInt","target","disabled","onClick","checked","length","center","zoom","style","height","width","url","attribution","isInZone","icon","opacity","title","description","owner_name","onViewMore","onOwnerClick","onClose","onUpdate","_c2","$RefreshReg$"],"sources":["C:/Users/David Noguera/Desktop/MapyWorks/control-mapy/src/components/mapa/Mapa.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\r\nimport { MapContainer, TileLayer, Marker, Popup, Circle, useMap } from 'react-leaflet';\r\nimport L from 'leaflet';\r\nimport 'leaflet/dist/leaflet.css';\r\nimport serviceService from '../../services/apiServices';\r\nimport ServiceCard from '../service_/ServiceCard';\r\nimport ServiceModal from '../service_/ServiceModal';\r\nimport Navbar from '../navbar/Navbar';\r\nimport './Mapa.css';\r\n\r\n// Fix for default markers in Leaflet with React\r\ndelete L.Icon.Default.prototype._getIconUrl;\r\nL.Icon.Default.mergeOptions({\r\n  iconRetinaUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png',\r\n  iconUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png',\r\n  shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png',\r\n});\r\n\r\n// Custom icon for services\r\nconst serviceIcon = new L.Icon({\r\n  iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-orange.png',\r\n  shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png',\r\n  iconSize: [25, 41],\r\n  iconAnchor: [12, 41],\r\n  popupAnchor: [1, -34],\r\n  shadowSize: [41, 41]\r\n});\r\n\r\n// Custom icon for user location\r\nconst userLocationIcon = new L.Icon({\r\n  iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-blue.png',\r\n  shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png',\r\n  iconSize: [25, 41],\r\n  iconAnchor: [12, 41],\r\n  popupAnchor: [1, -34],\r\n  shadowSize: [41, 41]\r\n});\r\n\r\n// Component to handle map events and location detection\r\nconst MapController = ({ onLocationFound, zoneCenter, zoneRadius }) => {\r\n  const map = useMap();\r\n\r\n  useEffect(() => {\r\n    // Add click handler to update zone center\r\n    const handleMapClick = (e) => {\r\n      onLocationFound(e.latlng, 'click');\r\n    };\r\n\r\n    map.on('click', handleMapClick);\r\n\r\n    return () => {\r\n      map.off('click', handleMapClick);\r\n    };\r\n  }, [map, onLocationFound]);\r\n\r\n  // Update zone circle when center or radius changes\r\n  useEffect(() => {\r\n    if (zoneCenter && zoneRadius > 0) {\r\n      // Remove existing circle\r\n      map.eachLayer((layer) => {\r\n        if (layer instanceof L.Circle && layer.options.color === 'red') {\r\n          map.removeLayer(layer);\r\n        }\r\n      });\r\n\r\n      // Add new circle\r\n      L.circle(zoneCenter, {\r\n        radius: zoneRadius,\r\n        color: 'red',\r\n        fillColor: '#f03',\r\n        fillOpacity: 0.2,\r\n        weight: 2\r\n      }).addTo(map);\r\n    }\r\n  }, [zoneCenter, zoneRadius, map]);\r\n\r\n  return null;\r\n};\r\n\r\nconst Mapa = () => {\r\n  const [services, setServices] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [zoneCenter, setZoneCenter] = useState(null);\r\n  const [zoneRadius, setZoneRadius] = useState(1000); // 1km default\r\n  const [showAllServices, setShowAllServices] = useState(false); // New state for showing all services\r\n  const [selectedService, setSelectedService] = useState(null);\r\n  const [showModal, setShowModal] = useState(false);\r\n  const [mapCenter, setMapCenter] = useState([-34.6037, -58.3816]); // Default to Buenos Aires\r\n\r\n  // Load services on component mount\r\n  useEffect(() => {\r\n    loadServices();\r\n  }, []);\r\n\r\n  const loadServices = async () => {\r\n    setLoading(true);\r\n    setError(null);\r\n    try {\r\n      const response = await serviceService.getServices(0, 1000, ''); // Load all services\r\n      setServices(response.services);\r\n    } catch (err) {\r\n      setError('Error al cargar los servicios');\r\n      console.error('Error loading services:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Get user current location\r\n  const handleGetCurrentLocation = () => {\r\n    if (!navigator.geolocation) {\r\n      alert('Geolocalización no es soportada por este navegador.');\r\n      return;\r\n    }\r\n\r\n    // Check if running on HTTPS or localhost\r\n    const isSecureContext = window.location.protocol === 'https:' ||\r\n                           window.location.hostname === 'localhost' ||\r\n                           window.location.hostname === '127.0.0.1';\r\n\r\n    if (!isSecureContext) {\r\n      alert('Para usar la geolocalización, el sitio debe ejecutarse en HTTPS o localhost. Actualmente estás en: ' + window.location.protocol + '//' + window.location.hostname);\r\n      return;\r\n    }\r\n\r\n    console.log('Requesting geolocation...');\r\n    navigator.geolocation.getCurrentPosition(\r\n      (position) => {\r\n        console.log('Geolocation success:', position.coords);\r\n        const coords = {\r\n          lat: position.coords.latitude,\r\n          lng: position.coords.longitude\r\n        };\r\n        setZoneCenter(coords);\r\n        setMapCenter([coords.lat, coords.lng]);\r\n        alert('¡Ubicación detectada correctamente!');\r\n      },\r\n      (error) => {\r\n        console.error('Geolocation error details:', {\r\n          code: error.code,\r\n          message: error.message,\r\n          PERMISSION_DENIED: error.PERMISSION_DENIED,\r\n          POSITION_UNAVAILABLE: error.POSITION_UNAVAILABLE,\r\n          TIMEOUT: error.TIMEOUT\r\n        });\r\n\r\n        let errorMessage = 'Error al obtener la ubicación: ';\r\n\r\n        switch(error.code) {\r\n          case error.PERMISSION_DENIED:\r\n            errorMessage += 'Permisos denegados. Por favor, permite el acceso a la ubicación en tu navegador.';\r\n            break;\r\n          case error.POSITION_UNAVAILABLE:\r\n            errorMessage += 'Ubicación no disponible. Verifica que tu dispositivo tenga GPS activado.';\r\n            break;\r\n          case error.TIMEOUT:\r\n            errorMessage += 'Tiempo agotado. Intenta nuevamente.';\r\n            break;\r\n          default:\r\n            errorMessage += 'Error desconocido. Verifica tu conexión a internet y permisos de ubicación.';\r\n            break;\r\n        }\r\n\r\n        alert(errorMessage + '\\n\\nPara desarrollo local, asegúrate de que el sitio se ejecute en localhost con HTTP o HTTPS.');\r\n      },\r\n      {\r\n        enableHighAccuracy: true,\r\n        timeout: 15000, // Increased timeout\r\n        maximumAge: 300000\r\n      }\r\n    );\r\n  };\r\n\r\n\r\n\r\n  // Handle location found (either from click or current location)\r\n  const handleLocationFound = useCallback((coords, source) => {\r\n    if (source === 'click') {\r\n      setZoneCenter(coords);\r\n    }\r\n  }, []);\r\n\r\n  // Calculate distance between two points using Haversine formula\r\n  const calculateDistance = (point1, point2) => {\r\n    const R = 6371; // Earth's radius in kilometers\r\n    const dLat = (point2.lat - point1.lat) * Math.PI / 180;\r\n    const dLon = (point2.lng - point1.lng) * Math.PI / 180;\r\n    const a =\r\n      Math.sin(dLat/2) * Math.sin(dLat/2) +\r\n      Math.cos(point1.lat * Math.PI / 180) * Math.cos(point2.lat * Math.PI / 180) *\r\n      Math.sin(dLon/2) * Math.sin(dLon/2);\r\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\r\n    return R * c;\r\n  };\r\n\r\n  // Filter services based on zone of interest\r\n  const servicesInZone = services.filter(service => {\r\n    if (!zoneCenter || !service.lat || !service.lng) return false;\r\n    const serviceLocation = { lat: service.lat, lng: service.lng };\r\n    const distance = calculateDistance(zoneCenter, serviceLocation);\r\n    return distance <= (zoneRadius / 1000); // Convert meters to kilometers\r\n  });\r\n\r\n  const handleViewMore = (service) => {\r\n    setSelectedService(service);\r\n    setShowModal(true);\r\n  };\r\n\r\n  const handleCloseModal = () => {\r\n    setShowModal(false);\r\n    setSelectedService(null);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Navbar />\r\n      <div className=\"mapa-container\">\r\n        <div className=\"mapa-controls\">\r\n          <div className=\"control-group\">\r\n            <label htmlFor=\"zone-radius\">Radio de zona de interés (metros):</label>\r\n            <input\r\n              id=\"zone-radius\"\r\n              type=\"range\"\r\n              min=\"100\"\r\n              max=\"20000\"\r\n              step=\"500\"\r\n              value={zoneRadius}\r\n              onChange={(e) => setZoneRadius(parseInt(e.target.value))}\r\n              className=\"zone-radius-slider\"\r\n              disabled={showAllServices}\r\n            />\r\n            <span className=\"radius-value\">{zoneRadius}m</span>\r\n          </div>\r\n\r\n          <button\r\n            onClick={handleGetCurrentLocation}\r\n            className=\"location-button\"\r\n          >\r\n            📍 Detectar Ubicación Actual\r\n          </button>\r\n\r\n\r\n\r\n          <div className=\"control-group\">\r\n            <label className=\"checkbox-label\">\r\n              <input\r\n                type=\"checkbox\"\r\n                checked={showAllServices}\r\n                onChange={(e) => setShowAllServices(e.target.checked)}\r\n                className=\"show-all-checkbox\"\r\n              />\r\n              Ver todos los servicios (sin zona de interés)\r\n            </label>\r\n          </div>\r\n\r\n          <div className=\"services-info\">\r\n            <p>Total de servicios: {services.length}</p>\r\n            <p>Servicios mostrados: {showAllServices ? services.length : servicesInZone.length}</p>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"mapa-content\">\r\n          <div className=\"map-container\">\r\n            <MapContainer\r\n              center={mapCenter}\r\n              zoom={13}\r\n              style={{ height: '100%', width: '100%' }}\r\n            >\r\n              <TileLayer\r\n                url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n                attribution=\"&copy; OpenStreetMap contributors\"\r\n              />\r\n\r\n              <MapController\r\n                onLocationFound={handleLocationFound}\r\n                zoneCenter={zoneCenter}\r\n                zoneRadius={zoneRadius}\r\n              />\r\n\r\n              {/* Service markers */}\r\n              {services.map(service => {\r\n                if (!service.lat || !service.lng) return null;\r\n                const isInZone = zoneCenter ?\r\n                  calculateDistance(zoneCenter, { lat: service.lat, lng: service.lng }) <= (zoneRadius / 1000) :\r\n                  false;\r\n\r\n                return (\r\n                  <Marker\r\n                    key={service.id}\r\n                    position={[service.lat, service.lng]}\r\n                    icon={serviceIcon}\r\n                    opacity={isInZone ? 1 : 0.5}\r\n                  >\r\n                    <Popup>\r\n                      <div className=\"service-popup\">\r\n                        <h4>{service.title}</h4>\r\n                        <p>{service.description}</p>\r\n                        {service.owner_name && <p><strong>Por:</strong> {service.owner_name}</p>}\r\n                        <button\r\n                          onClick={() => handleViewMore(service)}\r\n                          className=\"popup-view-more\"\r\n                        >\r\n                          Ver Más\r\n                        </button>\r\n                      </div>\r\n                    </Popup>\r\n                  </Marker>\r\n                );\r\n              })}\r\n            </MapContainer>\r\n          </div>\r\n\r\n          <div className=\"services-list\">\r\n            <h3>Servicios {showAllServices ? 'Registrados' : (zoneCenter ? 'en Zona de Interés' : 'Registrados')}</h3>\r\n\r\n            {loading && <div className=\"loading\">Cargando servicios...</div>}\r\n\r\n            {error && <div className=\"error\">{error}</div>}\r\n\r\n            {!loading && !error && !showAllServices && servicesInZone.length === 0 && zoneCenter && (\r\n              <div className=\"no-services\">\r\n                <p>No hay servicios en la zona de interés seleccionada.</p>\r\n                <p>Ajusta el radio o mueve el centro de la zona.</p>\r\n              </div>\r\n            )}\r\n\r\n            {!loading && !error && !showAllServices && servicesInZone.length === 0 && !zoneCenter && (\r\n              <div className=\"no-services\">\r\n                <p>Haz clic en el mapa para definir una zona de interés o usa el botón de ubicación actual.</p>\r\n              </div>\r\n            )}\r\n\r\n            {!loading && !error && showAllServices && services.length === 0 && (\r\n              <div className=\"no-services\">\r\n                <p>No hay servicios registrados en el sistema.</p>\r\n              </div>\r\n            )}\r\n\r\n            <div className=\"services-grid\">\r\n              {(showAllServices ? services : servicesInZone).map(service => (\r\n                <ServiceCard\r\n                  key={service.id}\r\n                  service={service}\r\n                  onViewMore={handleViewMore}\r\n                  onOwnerClick={() => {}} // TODO: Implement owner click if needed\r\n                />\r\n              ))}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {showModal && selectedService && (\r\n          <ServiceModal\r\n            service={selectedService}\r\n            onClose={handleCloseModal}\r\n            onUpdate={() => loadServices()}\r\n          />\r\n        )}\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Mapa;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}